<div class="card-collapse">
  <div class="card-header" role="tab" id="headingTwo">
    <h5 class="mb-0">
      <a class="collapsed" data-toggle="collapse" href="#comment-{{comment.id}}" aria-expanded="true"
        attr.aria-controls="comment-{{comment.id}}">
        {{comment.usersBycreatedBy.name || 'Anonymous'}}, {{comment.modified_at | date:short}}
        <i class="material-icons">keyboard_arrow_down</i>
      </a>
    </h5>
  </div>
  <div id="comment-{{comment.id}}" class="collapse show" role="tabpanel" aria-labelledby="headingTwo"
    attr.data-target="#comment-{{comment.id}}">
    <div class="card-body">
      <div innerHTML="{{comment.text}}"></div>
      <p>
        <span *ngFor="let attachment of comment.attachments; let i= index;" style="cursor:pointer;">
          <img *ngIf="attachment.mimeType.startsWith('image')" src="{{attachment['url']}}"
            (click)="assignUrl(comment.attachments, i)" width="50" />

          <!-- icon in case url is of video -->
          <i class="material-icons" style="zoom:2; color: grey;" *ngIf="attachment.mimeType.startsWith('video')"
            (click)="assignUrl(comment.attachments, i)">
            movie
          </i>
          <i class="material-icons" style="zoom:2; color: grey;"
            *ngIf="!attachment.mimeType.startsWith('video') && !attachment.mimeType.startsWith('image')"
            (click)="assignUrl(comment.attachments, i)">
            description
          </i>
        </span>
      </p>

      <button mat-raised-button class="btn btn-warning btn-round btn-sm" matTooltip="Click to reply"
        [matTooltipPosition]="'below'" *ngIf="!(showReplyBox && replyingTo === comment.id)"
        (click)="replyTo(comment.id)">Reply</button>
      <app-submit-comment *ngIf="showReplyBox && replyingTo === comment.id" [users]="users" [actionText]="'Reply'"
        [cancelShown]="true" [id]="comment.id" (cancel)="showReplyBox=false" (submit)="onCommentSubmit($event)">
      </app-submit-comment>
      <div class="card-collapse" *ngFor="let reply of sortReplies(replies)">
        <div class="card-header" role="tab" id="headingTwo">
          <h5 class="mb-0">
            <a class="collapsed" data-toggle="collapse" href="#reply-{{reply.id}}" aria-expanded="false"
              attr.aria-controls="reply-{{reply.id}}">
              {{reply.usersBycreatedBy.name || 'Anonymous'}}, {{reply.modified_at | date:short}}
              <i class="material-icons">keyboard_arrow_down</i>
            </a>
          </h5>
        </div>
        <div id="reply-{{reply.id}}" class="collapse" role="tabpanel" aria-labelledby="headingTwo"
          attr.data-target="#reply-{{reply.id}}">
          <div class="card-body">
            <div innerHTML="{{reply.text}}"></div>
            <p>
              <span *ngFor="let attachment of reply.attachments; let i=index;" style="cursor:pointer;">
                <img *ngIf="attachment.mimeType.startsWith('image')" (click)="assignUrl(reply.attachments, i)"
                  src="{{attachment['url']}}" width="50" />

                <!-- icon in case url is of video -->
                <i class="material-icons" style="zoom:2; color: grey" *ngIf="attachment.mimeType.startsWith('video')"
                  (click)="assignUrl(reply.attachments, i)">
                  movie
                </i>
                <i class="material-icons" style="zoom:2; color: grey"
                  *ngIf="!attachment.mimeType.startsWith('video') && !attachment.mimeType.startsWith('image')"
                  (click)="assignUrl(reply.attachments, i)">
                  description
                </i>
              </span>
            </p>

            <!-- <button mat-raised-button class="btn btn-warning btn-round btn-sm" matTooltip="Click to reply" [matTooltipPosition]="'below'" *ngIf="!(showReplyBox && replyingTo === reply.id)"
        (click)="replyTo(reply.id)">Reply</button>
        <app-submit-comment *ngIf="showReplyBox && replyingTo === reply.id" [users]="objectValues(usersService.allUsers)"
        [actionText]="'Reply'" [cancelShown]="true" (cancel)="showReplyBox=false" (submit)="onCommentSubmit($event)"></app-submit-comment> -->
          </div>
        </div>
      </div>
    </div>
  </div>
</div>