<div class="main-content">
  <div class="container-fluid">
    <div class="row">
      <!--Solution Details-->
      <div class="col-md-8">
        <div class="card card-product">
          <div class="card-header card-header-rose fixed-top">
            <h4 class="card-title">{{solutionData.title}}</h4>
            <p class="card-category"><b>Created By :
                {{ (auth.currentUserValue.id == solutionData.created_by) ? 'You' : solutionOwner }}</b></p>
          </div>
          <div class="card-body">
            <div class="row">
              <div class="col-md-4">
                <div class="picture text-center">
                  <img
                    src="{{(solutionData.featured_url && checkUrlIsImg(solutionData.featured_url)) ? solutionData.featured_url : './assets/img/image_placeholder.jpg'}}"
                    alt="Thumbnail Image" class="rounded img-fluid">
                  <div>
                    <button mat-raised-button *ngIf="solution_attachments && solution_attachments.length > 0"
                      class="btn btn-raised btn-info btn-sm" data-toggle="modal"
                      (click)="openModal('#viewMoreImgModal')">
                      view media ({{solution_attachments.length}})
                    </button>
                  </div>
                </div>
              </div>
              <div class="col-md-8">
                <strong *ngIf="solutionData.description">Description</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.description}}</p>

                <strong *ngIf="solutionData.organization">Organization</strong>
                <p class="description">{{solutionData.organization}}</p>

                <strong *ngIf="solutionData.technology">Innovation</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.technology}}</p>

                <strong *ngIf="solutionData.resources">Resources Needed</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.resources}}</p>

                <strong *ngIf="solutionData.impact">Impact</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.impact}}</p>

                <strong *ngIf="solutionData.timeline">Timeline</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.timeline}}</p>

                <strong *ngIf="solutionData.pilots">Pilots</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.pilots}}</p>

                <strong *ngIf="solutionData.website_url">Website</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.website_url}}</p>

                <strong *ngIf="solutionData.deployment">Deployments</strong>
                <p class="description" style="white-space: pre-wrap;">{{solutionData.deployment}}</p>

                <strong *ngIf="solutionData.budget">Budget</strong>
                <div class="row">
                  <div class="col-md-5">
                    <p class="description" style="white-space: pre-wrap;">{{solutionData.budget.title}}</p>
                  </div>
                  <span>-</span>
                  <div class="col-md-5">
                    <p class="description" style="white-space: pre-wrap;">{{solutionData.budget.cost}}</p>
                  </div>
                </div>

                <strong *ngIf="ownerNames.length">Solver Team</strong>
                <div>
                  <span *ngFor="let owner of ownerNames" class="badge badge-rose"
                    style="margin-right: 0.3em;">{{owner}}</span>
                  <span>&nbsp;</span>
                </div>
              </div>
            </div>
          </div>
          <div class="card-footer">
            <div class="stats">
              <i class="material-icons actions" (click)="toggleVoteSolution()"
                [ngStyle]="{'color':voters.has(userId) ? '#1E90FF' : 'black' }">
                thumb_up
              </i>
              <span>{{voters.size}}</span>
              <i class="material-icons actions col-md-3" (click)="toggleWatchSolution()"
                [ngStyle]="{'color':watchers.has(userId) ? '#1E90FF' : 'black' }">
                visibility
              </i>
              <span> {{watchers.size}}</span>
              <!-- <i *ngIf="userId===solutionData.created_by" [routerLink]="
                '/problems/'+ solutionData.id+'/edit'" class="material-icons actions">
                create
              </i> -->
            </div>

            <!--  -->
            <div class="dropdown">
              <button *ngIf="userId===solutionData.created_by" [routerLink]="
                '/solutions/'+ solutionData.id+'/edit'" class="btn btn-sm btn-rose" aria-expanded="true">
                <i class="material-icons actions">
                  create
                </i>
              </button>
              <span>&nbsp;</span>
              <span>&nbsp;</span>
              <button href="#" class="btn btn-sm btn-rose" data-toggle="dropdown" aria-expanded="true">
                <i class="material-icons actions">
                  share
                </i>
              </button>
              <!-- <ul class="dropdown-menu">
                <li *ngIf="channels.linkedin"><a (click)="linkedInShare()">LinkedIn</a></li>
                <li *ngIf="channels.facebook"><a (click)="fbShare()">Facebook</a></li>
                <li *ngIf="channels.twitter"><a (click)="twitterShare()">Twitter</a></li>
                <li *ngIf="channels.email"><a (click)="mailShare()">Email</a></li>
                <li *ngIf="channels.sms"><a (click)="smsShare()">SMS</a></li>
              </ul> -->
            </div>

          </div>
        </div>



        <!--Show more images and videos-->

        <!-- ----------------------------- solution attachments modal start----------------------------- -->
        <div class="modal fade" id="viewMoreImgModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
          aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                  (click)="closeModal($event)">
                  <i class="material-icons">close</i>
                </button>
              </div>
              <div class="modal-body">
                <app-display-modal *ngIf="solution_attachments_src && solution_attachments_src.url"
                  [source]="solution_attachments[solution_attachments_index]">
                </app-display-modal>
              </div>
              <div class="modal-footer justify-content-center" *ngIf="this.solution_attachments.length > 1">
                <button mat-raised-button type="button" [disabled]="solution_attachments_index < 1"
                  (click)="toggleSolutionAttachmentsIndex(false)" class="btn btn-link btn-round btn-twitter"><i
                    class="material-icons" style="zoom:2;">
                    keyboard_arrow_left
                  </i>
                </button>
                <div class="col-3 text-center"><strong>{{solution_attachments_index + 1}}</strong></div>
                <button mat-raised-button type="button"
                  [disabled]="solution_attachments_index === solution_attachments.length - 1"
                  class="btn btn-link btn-round btn-twitter" (click)="toggleSolutionAttachmentsIndex(true)"><i
                    class="material-icons" style="zoom:2;">
                    keyboard_arrow_right
                  </i>
                </button>
              </div>
            </div>
          </div>
        </div>
        <!-- ----------------------------- solution attachments modal ends----------------------------- -->


        <div class="row justify-content-center">
          <!-- <a mat-button>
            <i class="material-icons">
              keyboard_arrow_left
            </i>
          </a> -->
          <button mat-raised-button class="btn btn-rose btn-round" data-toggle="modal" data-target="#validatorModal"
            matTooltip="Click to validate solution" [matTooltipPosition]="'below'"
            [disabled]="disableValidateButton || userId == solutionData.created_by || !auth.currentUserValue.id "
            *ngIf="auth.currentUserValue.id">Validate</button>
          <!-- <a mat-button>
            <i class="material-icons">
              keyboard_arrow_right
            </i>
          </a> -->
        </div>
        <!--Validate divider-->

        <ngu-carousel #ValidCarousel [inputs]="carouselTileConfig" [dataSource]="carouselTileItemsValid$ | async"
          *ngIf="validation[0] ">
          <ngu-tile *nguCarouselDef="let validation; let i = index; let ani = animate" data-toggle="modal"
            data-target="#validModal">
            <app-validate-card *ngIf="!validation.is_deleted" [validationData]="validation"
              (clicked)="handleValidationCardClicked($event)"></app-validate-card>
          </ngu-tile>

          <!-- <button NguCarouselPrev class="btn btn-default leftRs" [style.opacity]="ValidCarousel.isFirst ? 0.5:1">&lt;</button> -->
          <!-- <button NguCarouselNext class="btn btn-default rightRs" [style.opacity]="ValidCarousel.isLast ? 0.5:1">&gt;</button> -->


          <a mat-button NguCarouselPrev class="btn btn-white btn-just-icon btn-round leftRs"
            *ngIf="validation[0]&&validation.length>2">
            <i class="material-icons">
              keyboard_arrow_left
            </i>
          </a>
          <!-- <button mat-raised-button class="btn btn-warning btn-round" data-toggle="modal" data-target="#validatorModal" -->
          <!-- matTooltip="Click to validate problem" [matTooltipPosition]="'below'">Validate</button> -->
          <a mat-button NguCarouselNext class="btn btn-white btn-just-icon btn-round rightRs"
            *ngIf="validation[0]&&validation.length>2">
            <i class="material-icons">
              keyboard_arrow_right
            </i>
          </a>

        </ngu-carousel>
        <div class="row justify-content-center" *ngIf="!validation[0]">
          <!-- <p *ngIf="userPersonas.is_expert">No validations yet. Be the first to validate.</p> -->
          <p>No validations yet.</p>

        </div>

        <div class="row justify-content-center">
          <!-- 
        <p
          *ngIf="!(userId == solutionData.created_by) && userPersonas.is_expert && !sectorMatched && !disableValidateButton">
          Please ensure that
          your interests match with the problem
          sectors in order to validate</p> -->

        </div>


        <!--Validate Modal-->
        <div class="modal fade" id="validatorModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
          aria-hidden="true">
          <div class="modal-dialog modal-notice">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">Validate Solution</h5>
                <button mat-button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                  <i class="material-icons">close</i>
                </button>
              </div>
              <div class="modal-body">
                <app-add-validation (submitted)="onValidationSubmit($event)"></app-add-validation>
              </div>
            </div>
          </div>
        </div>
        <!--Validate Modal-->

        <!--View Validation Modal-->

        <div class="modal fade" id="validModal" tabindex="-1" role="dialog" aria-labelledby="ModalLabel"
          aria-hidden="true">
          <div class="modal-dialog modal-notice">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">Validation Details</h5>
                <button mat-button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                  <i class="material-icons">close</i>
                </button>
              </div>
              <div class="modal-body">
                <app-detailed-validate-view [validationData]="validationDataToView"
                  (deleteClicked)="deleteValidation($event)" (editClicked)="handleValidationEditMode($event)">
                </app-detailed-validate-view>
              </div>
            </div>
          </div>
        </div>

        <!--View Validation Modal-->

        <!--Edit Validation Modal-->
        <div class="modal fade editModal" id="EditValidationModal" tabindex="-1" role="dialog"
          aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-notice">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">Edit Validation</h5>
                <button mat-button type="button" class="close" data-dismiss="modal" aria-hidden="true"
                  (click)="closeModal($event)">
                  <i class="material-icons">close</i>
                </button>
              </div>
              <div class="modal-body">
                <app-add-validation *ngIf="validationDataToEdit" [validationData]="validationDataToEdit"
                  (submitted)="onValidationSubmit($event)"></app-add-validation>
              </div>
            </div>
          </div>
        </div>
        <!--Edit Validation Modal-->

        <!--Validate-->

        <hr>

        <!--Collaborate-->

        <div class="modal fade editModal" id="EditCollaborateModal" tabindex="-1" role="dialog"
          aria-labelledby="myModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-notice modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">Edit collaboration</h5>
                <button mat-button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                  <i class="material-icons">close</i>
                </button>
              </div>
              <div class="modal-body">


                <app-add-collaborator *ngIf="collaboratorDataToEdit" [collaborator]="collaboratorDataToEdit"
                  (submitted)="onCollaborationSubmit($event)">

                </app-add-collaborator>
              </div>
            </div>
          </div>
        </div>

        <!--Collaborate divider-->
        <div class="row justify-content-center">
          <!-- <a mat-button>
            <i class="material-icons">
              keyboard_arrow_left
            </i>
          </a> -->
          <button mat-raised-button *ngIf="auth.currentUserValue.id" class="btn btn-rose btn-round" data-toggle="modal"
            data-target="#collaboratorModal" matTooltip="Click to collaborate"
            [disabled]="disableCollaborateButton || userId == solutionData.created_by || !auth.currentUserValue.id "
            [matTooltipPosition]="'below'">Collaborate</button>
          <p *ngIf="!auth.currentUserValue.id">Login to collaborate on this solution</p>
          <!-- <a mat-button>
            <i class="material-icons">
              keyboard_arrow_right
            </i>
          </a> -->
        </div>
        <!--Collaborate divider-->

        <ngu-carousel #CollabCarousel [inputs]="carouselTileConfig" [dataSource]="carouselTileItemCollab$ | async"
          *ngIf="collaborators[0]">
          <ngu-tile *nguCarouselDef="let collaborator; let i = index; let ani = animate">
            <app-collaborator-card *ngIf="collaborator" [collaboratorData]="collaborator"
              (editClicked)="handleCollaborationEditMode($event)" (deleteClicked)="deleteCollaboration($event)">
            </app-collaborator-card>
          </ngu-tile>



          <a mat-button NguCarouselPrev class="btn btn-white btn-just-icon btn-round leftRs"
            *ngIf="collaborators[0]&&collaborators.length>2">
            <i class="material-icons">
              keyboard_arrow_left
            </i>
          </a>

          <a mat-button NguCarouselNext class="btn btn-white btn-just-icon btn-round rightRs"
            *ngIf="collaborators[0]&&collaborators.length>2">
            <i class="material-icons">
              keyboard_arrow_right
            </i>
          </a>
        </ngu-carousel>
        <div class="row justify-content-center">
          <!-- <p *ngIf="!collaborators[0]">No collaborators yet.</p> -->

          <p *ngIf="!collaborators[0]">No collaborators yet.</p>
          <!-- <ng-template #notUser>&nbsp; No collaborators yet.</ng-template> -->

        </div>

        <hr>



        <!--solution carousel start-->
        <div class="row justify-content-center">
          <!-- <a mat-button NguCarouselPrev class="leftRs">
              <i class="material-icons">
                keyboard_arrow_left
              </i>
            </a> -->
          <h4 *ngIf="problems[0]">Problems</h4>
          <!-- <button mat-raised-button *ngIf="auth.currentUserValue.id" class="btn btn-warning btn-round"
            matTooltip="Click to add enrichment" [matTooltipPosition]="'below'"
            [disabled]="disableEnrichButton || !auth.currentUserValue.id"
            [routerLink]="['/enrichment/add',{problemId:problemData.id}]">Enrich</button>
          <p *ngIf="!auth.currentUserValue.id">Login to enrich the problem</p> -->
          <!-- <a mat-button NguCarouselNext class="rightRs">
              <i class="material-icons">
                keyboard_arrow_right
              </i>
            </a> -->
        </div>
        <!--Enrichment divider-->

        <ngu-carousel #problemCarousel [inputs]="carouselTileConfig" [dataSource]="carouselTileItemProblems$ | async"
          *ngIf="problems[0]">
          <ngu-tile *nguCarouselDef="let problem; let i = index; let ani = animate" data-toggle="modal"
            (click)="openModal('#enrichModal')">

            <app-problem-card [problemData]="problem">
            </app-problem-card>
          </ngu-tile>

          <!-- <button NguCarouselPrev class="btn btn-default leftRs" [style.opacity]="enrichCarousel.isFirst ? 0.5:1">&lt;</button> -->
          <!-- <button NguCarouselNext class="btn btn-default rightRs" [style.opacity]="enrichCarousel.isLast ? 0.5:1">&gt;</button> -->

          <!-- <div class="row justify-content-center"> -->
          <a mat-button NguCarouselPrev class="btn btn-white btn-just-icon btn-round leftRs"
            *ngIf="problems[0]&&problems.length>2">
            <i class="material-icons">
              keyboard_arrow_left
            </i>
          </a>
          <!-- <button mat-raised-button class="btn btn-warning btn-round" data-toggle="modal" data-target="#enrichmentModal" -->
          <!-- matTooltip="Click to add enrichment" [matTooltipPosition]="'below'">Enrich</button> -->
          <a mat-button NguCarouselNext class="btn btn-white btn-just-icon btn-round rightRs"
            *ngIf="problems[0]&&problems.length>2">
            <i class="material-icons">
              keyboard_arrow_right
            </i>
          </a>
          <!-- </div> -->


        </ngu-carousel>



        <!--Add Collaborator Modal-->
        <div class="modal fade" id="collaboratorModal" tabindex="-1" role="dialog" aria-labelledby="myModalLabel"
          aria-hidden="true">
          <div class="modal-dialog modal-notice modal-lg">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="myModalLabel">How do I collaborate</h5>
                <button mat-button type="button" class="close" aria-hidden="true" (click)="dismiss()">
                  <i class="material-icons">close</i>
                </button>
              </div>
              <div class="modal-body">
                <app-add-collaborator (submitted)="onCollaborationSubmit($event)" (intentValue)="checkIntent($event)"
                  (edit)=onCollaorationUpdate($event)>
                </app-add-collaborator>
              </div>
            </div>
          </div>
        </div>
        <!--Add Collaborator Modal-->

        <!--Collaborate-->

        <!-- </div> -->

      </div>

      <div class="col-md-4">
        <div class="card" *ngIf="auth.currentUserValue.id">
          <div class="card-header">
            <!-- <div class="row justify-content-center">
              <i class="material-icons">
                highlight
              </i>
              <span>&nbsp;</span>
              <span>&nbsp;</span>
              <span>&nbsp;</span>
              <span>&nbsp;</span>
              <h5>Do you have a solution? <a [routerLink]="['/solutions/add',{problemId:problemData.id}]">click here</a>
              </h5>
            </div>
          </div> -->
          </div>
          <div class="card">
            <div class="card-header card-header-icon card-header-rose">
              <div class="card-icon">
                <i class="material-icons">forum</i>
              </div>
              <h4 class="card-title">Discussions</h4>
            </div>
            <div class="card-body" *ngIf="!auth.currentUserValue.id">
              <p>Login to join discussion for this solution</p>
            </div>
            <div class="card-body" *ngIf="auth.currentUserValue.id">
              <button mat-raised-button class="btn btn-warning btn-sm" (click)="showPopularDiscussions('latest')"
                *ngIf="objectValues(comments).length">Latest</button>
              <button mat-raised-button class="btn btn-warning btn-sm" *ngIf="objectValues(comments).length"
                (click)="showPopularDiscussions('popular')">Popular</button>

              <div id="accordion" role="tablist">
                <div class="card-collapse">
                  <div class="card-header" role="tab" id="headingOne">
                    <h5 class="mb-0">
                      <a data-toggle="collapse" href="#newComment" *ngIf="auth.currentUserValue.id"
                        aria-expanded=" true" aria-controls="newComment" class="collapsed">
                        Join Discussion
                        <i class="material-icons">keyboard_arrow_down</i>
                      </a>
                    </h5>
                  </div>
                  <div id="newComment" class="collapse show" role="tabpanel" aria-labelledby="headingOne"
                    data-target="#newComment">
                    <app-submit-comment [users]="objectValues(usersService.allUsers)" [actionText]="'Comment'"
                      (submit)="onCommentSubmit($event)" [pageType]="'solution'"></app-submit-comment>
                  </div>
                </div>


                <div *ngIf="!popular">
                  <app-display-comment [users]="objectValues(usersService.allUsers)" [comment]="comment"
                    [replies]="replies[comment.id]" [pageType]="'solution'"
                    (reply)="onCommentSubmit($event, comment.id)" (commentToDelete)="deleteComment($event)"
                    (shareCommentId)="shareComment($event)" (fileClicked)="displayModal($event)"
                    *ngFor="let comment of sortComments(objectValues(comments))">
                  </app-display-comment>
                </div>

                <!--Popular-->

                <div *ngIf="popular">
                  <app-display-comment [users]="objectValues(usersService.allUsers)" [comment]="popularDiscussion"
                    [replies]="replies[popularDiscussion.id]" [pageType]="'solution'"
                    (reply)="onCommentSubmit($event, popularDiscussion.id)" (fileClicked)="displayModal($event)"
                    *ngFor="let popularDiscussion of popularDiscussions">
                  </app-display-comment>
                </div>

                <!--Popular-->

              </div>
              <hr>
              <a class="viewMoreComments" href="javascript:void(0)"
                *ngIf="objectValues(comments).length > 5 && numOfComments < objectValues(comments).length"
                (click)="showMoreComments()">
                View more comments
              </a>
            </div>
          </div>
        </div>


      </div>
    </div>
  </div>

  <!-- discuss image and video modal starts -->

  <div class="modal fade" id="enlargeView" style="display: none;">
    <div class="modal-dialog modal-lg">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true" (click)="closeModal($event)">
            <i class="material-icons">close</i>
          </button>
        </div>
        <div class="modal-body">
          <app-display-modal *ngIf="modalSrc && modalSrc['url']" [source]="modalSrc">
          </app-display-modal>
        </div>
        <div class="modal-footer justify-content-center" *ngIf="sources && sources['attachmentObj'].length > 1">
          <button mat-raised-button type="button" [disabled]="sources['index'] < 1" (click)="toggleFileSrc(false)"
            class="btn btn-info btn-round"><span class="carousel-control-prev-icon" aria-hidden="true"></span></button>
          <div class="col-3"></div>
          <button mat-raised-button type="button" [disabled]="sources['index'] == sources['attachmentObj'].length-1"
            class="btn btn-info btn-round" (click)="toggleFileSrc(true)"><span class="carousel-control-next-icon"
              aria-hidden="true"></span></button>
        </div>
      </div>
    </div>